
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doc2Me - Doctor-Driven Patient Education</title>
    <meta name="description" content="Doc2Me helps doctors create and share content with their patients effortlessly using AI." />
    <meta name="author" content="Doc2Me" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    
    <!-- Simple favicon configuration that uses existing files as fallback -->
    <link rel="icon" href="/favicon.ico" />
    <link id="dynamic-favicon" rel="icon" type="image/png" href="/favicon.ico" />
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap">
    <style>
      @font-face {
        font-family: 'SF Pro Display';
        src: url('https://applesocial.s3.amazonaws.com/assets/styles/fonts/sanfrancisco/sanfranciscodisplay-regular-webfont.woff2') format('woff2');
        font-weight: 400;
        font-style: normal;
      }
      @font-face {
        font-family: 'SF Pro Display';
        src: url('https://applesocial.s3.amazonaws.com/assets/styles/fonts/sanfrancisco/sanfranciscodisplay-medium-webfont.woff2') format('woff2');
        font-weight: 500;
        font-style: normal;
      }
      @font-face {
        font-family: 'SF Pro Display';
        src: url('https://applesocial.s3.amazonaws.com/assets/styles/fonts/sanfrancisco/sanfranciscodisplay-semibold-webfont.woff2') format('woff2');
        font-weight: 600;
        font-style: normal;
      }
      @font-face {
        font-family: 'SF Pro Display';
        src: url('https://applesocial.s3.amazonaws.com/assets/styles/fonts/sanfrancisco/sanfranciscodisplay-bold-webfont.woff2') format('woff2');
        font-weight: 700;
        font-style: normal;
      }
    </style>
    <!-- Cookie consent script -->
    <script type="text/javascript">
    var _iub = _iub || [];
    _iub.csConfiguration = {"askConsentAtCookiePolicyUpdate":true,"countryDetection":true,"enableLgpd":true,"enableUspr":true,"floatingPreferencesButtonDisplay":"bottom-right","lgpdAppliesGlobally":false,"perPurposeConsent":true,"siteId":3091222,"usprPurposes":"s,sh,adv","whitelabel":false,"cookiePolicyId":92059710,"banner":{"acceptButtonDisplay":true,"backgroundColor":"#FFFFFF","closeButtonDisplay":false,"customizeButtonDisplay":true,"explicitWithdrawal":true,"listPurposes":true,"logo":null,"linksColor":"#000000","ownerName":"Doc2Me","position":"float-bottom-right","rejectButtonDisplay":true,"showTotalNumberOfProviders":true,"textColor":"#000000"}};
    _iub.csLangConfiguration = {"de":{"cookiePolicyId":92059710},"en":{"cookiePolicyId":39385510}};
    </script>
    <script type="text/javascript" src="https://cs.iubenda.com/autoblocking/3091222.js"></script>
    <script type="text/javascript" src="//cdn.iubenda.com/cs/gpp/stub.js"></script>
    <script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script>
  </head>

  <body>
    <div id="root"></div>
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Script to fetch and set favicon from Supabase -->
    <script>
      // Function to set favicon from Supabase storage
      async function setFaviconFromSupabase() {
        try {
          console.log("Attempting to fetch favicon from Supabase edge function");
          
          // Get the API key from the supabase client
          const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVhcWVjdnJiendoZGt4bm5kZmt3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI1MDE0MTUsImV4cCI6MjA1ODA3NzQxNX0.8m6A8lNVG5A-BqFCQ28nDUuu7sXhsm-cPgHgzbZCL6I";
          
          // First try to call our edge function to ensure the favicon is uploaded
          const response = await fetch('https://eaqecvrbzwhdkxnndfkw.supabase.co/functions/v1/upload-favicon', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
              'apikey': SUPABASE_ANON_KEY
            },
            cache: 'no-cache' // Add no-cache to prevent browser caching
          });
          
          if (response.ok) {
            const data = await response.json();
            console.log("Edge function response:", data);
            
            if (data.success && data.url) {
              // Set the favicon to the URL returned by the edge function
              const dynamicFavicon = document.getElementById('dynamic-favicon');
              if (dynamicFavicon) {
                dynamicFavicon.href = data.url + '?v=' + new Date().getTime(); // Add timestamp to bypass cache
                console.log('Favicon set from Supabase storage:', data.url);
              } else {
                console.error('dynamic-favicon element not found');
              }
            } else {
              console.error('Edge function did not return a success response:', data);
            }
          } else {
            console.error('Failed to fetch favicon from edge function, status:', response.status);
            const errorText = await response.text();
            console.error('Error details:', errorText);
          }
        } catch (error) {
          console.error('Error setting favicon from Supabase:', error);
        }
      }
      
      // Call the function when the page loads
      window.addEventListener('load', setFaviconFromSupabase);
    </script>
  </body>
</html>
